<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Starlight Page Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: Consolas, monospace;
  background: #0f1117;
  color: #e6edf3;
  height: 100vh;
  display: flex;
}

/* Layout */
.editor {
  width: 50%;
  display: flex;
  flex-direction: column;
  background: #0d1117;
}

.preview {
  width: 50%;
  background: #ffffff;
  position: relative;
}

/* Header */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  background: #161b22;
  border-bottom: 1px solid #30363d;
}

.run-btn {
  background: #238636;
  color: white;
  border: none;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

.run-btn:hover {
  background: #2ea043;
}

.logo {
  height: 28px;
}

/* Editor */
.code-container {
  position: relative;
  flex: 1;
  overflow: hidden;
}

.highlight {
  position: absolute;
  inset: 0;
  padding: 14px;
  white-space: pre-wrap;
  word-wrap: break-word;
  pointer-events: none;
  color: transparent;
}

textarea {
  position: absolute;
  inset: 0;
  background: transparent;
  color: #e6edf3;
  border: none;
  resize: none;
  padding: 14px;
  outline: none;
  font-size: 14px;
  line-height: 1.5;
  caret-color: #58a6ff;
}

/* Syntax colors */
.tag { color: #7ee787; }
.attr { color: #79c0ff; }
.string { color: #a5d6ff; }
.comment { color: #8b949e; }
.keyword { color: #ff7b72; }

/* Preview */
iframe {
  border: none;
  width: 100%;
  height: 100%;
}

/* Preview top */
.preview-top {
  position: absolute;
  top: 10px;
  right: 14px;
  z-index: 10;
}
  .css-selector { color: #d2a8ff; }
.css-prop { color: #79c0ff; }
.css-value { color: #a5d6ff; }

.keyword { color: #ff7b72; font-weight: 500; }

</style>
</head>

<body>

<!-- Editor -->
<div class="editor">
  <div class="topbar">
    <div><i class="fa-solid fa-code"></i> Starlight PageTest</div>
    <button class="run-btn" onclick="runCode()">
      <i class="fa-solid fa-play"></i> Run
    </button>
  </div>

  <div class="code-container">
    <pre class="highlight" id="highlight"></pre>
    <textarea id="code" spellcheck="false">
<!DOCTYPE html>
<html>
<head>
<style>
body {
  font-family: Arial;
  background: #f4f4f4;
}
h1 { color: purple; }
</style>
</head>

<body>
<h1>Hello Starlight</h1>
<p>Edit HTML, CSS & JS together.</p>

<script>
console.log("Starlight ready!");
</script>
</body>
</html>
    </textarea>
  </div>
</div>

<!-- Preview -->
<div class="preview">
  <div class="preview-top">
    <img class="logo" src="https://dominexmacedon.github.io/starlight-programming-language/logo/starlight-lang-logo.png">
  </div>
  <iframe id="output"></iframe>
</div>

<script>
const textarea = document.getElementById("code");
const highlight = document.getElementById("highlight");

function escapeHTML(code) {
  return code.replace(/&/g, "&amp;")
             .replace(/</g, "&lt;")
             .replace(/>/g, "&gt;");
}

function highlightHTML(code) {
  return code
    .replace(/(&lt;!--[\s\S]*?--&gt;)/g, '<span class="comment">$1</span>')
    .replace(/(&lt;\/?[a-z][^&gt;]*&gt;)/gi, match => {
      return match
        .replace(/(&lt;\/?)([a-z]+)/i, '$1<span class="tag">$2</span>')
        .replace(/([a-z-]+)=/gi, '<span class="attr">$1</span>=')
        .replace(/(".*?")/g, '<span class="string">$1</span>');
    });
}

function highlightCSS(code) {
  return code
    .replace(/([^{]+){/g, '<span class="css-selector">$1</span>{')
    .replace(/([a-z-]+)\s*:/g, '<span class="css-prop">$1</span>:')
    .replace(/:\s*([^;]+);/g, ': <span class="css-value">$1</span>;');
}

function highlightJS(code) {
  return code
    .replace(/(".*?"|'.*?')/g, '<span class="string">$1</span>')
    .replace(/\b(const|let|var|if|else|for|while|function|return|console)\b/g,
      '<span class="keyword">$1</span>');
}

function highlightCode() {
  let code = escapeHTML(textarea.value);

  code = code.replace(
    /(&lt;style&gt;)([\s\S]*?)(&lt;\/style&gt;)/gi,
    (_, open, css, close) =>
      open + highlightCSS(css) + close
  );

  code = code.replace(
    /(&lt;script&gt;)([\s\S]*?)(&lt;\/script&gt;)/gi,
    (_, open, js, close) =>
      open + highlightJS(js) + close
  );

  code = highlightHTML(code);
  highlight.innerHTML = code;
}

textarea.addEventListener("input", highlightCode);
textarea.addEventListener("scroll", () => {
  highlight.scrollTop = textarea.scrollTop;
});

function runCode() {
  document.getElementById("output").srcdoc = textarea.value;
}

highlightCode();
runCode();
</script>

</body>
</html>
