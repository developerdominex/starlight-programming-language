<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Starlight Page Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: Consolas, monospace;
  background: #0f1117;
  color: #e6edf3;
  height: 100vh;
  display: flex;
}

/* Layout */
.editor {
  width: 50%;
  display: flex;
  flex-direction: column;
  background: #0d1117;
}

.preview {
  width: 50%;
  background: #ffffff;
  position: relative;
}

/* Header */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  background: #161b22;
  border-bottom: 1px solid #30363d;
}

.run-btn {
  background: #238636;
  color: white;
  border: none;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

.run-btn:hover {
  background: #2ea043;
}

.logo {
  height: 28px;
}

/* Editor */
.code-container {
  position: relative;
  flex: 1;
  overflow: hidden;
}

.highlight {
  position: absolute;
  inset: 0;
  padding: 14px;
  white-space: pre-wrap;
  word-wrap: break-word;
  pointer-events: none;
  color: transparent;
}

textarea {
  position: absolute;
  inset: 0;
  background: transparent;
  color: #e6edf3;
  border: none;
  resize: none;
  padding: 14px;
  outline: none;
  font-size: 14px;
  line-height: 1.5;
  caret-color: #58a6ff;
}

/* Syntax colors */
.tag { color: #7ee787; }
.attr { color: #79c0ff; }
.string { color: #a5d6ff; }
.comment { color: #8b949e; }
.keyword { color: #ff7b72; }

/* Preview */
iframe {
  border: none;
  width: 100%;
  height: 100%;
}

/* Preview top */
.preview-top {
  position: absolute;
  top: 10px;
  right: 14px;
  z-index: 10;
}
</style>
</head>

<body>

<!-- Editor -->
<div class="editor">
  <div class="topbar">
    <div><i class="fa-solid fa-code"></i> Starlight PageTest</div>
    <button class="run-btn" onclick="runCode()">
      <i class="fa-solid fa-play"></i> Run
    </button>
  </div>

  <div class="code-container">
    <pre class="highlight" id="highlight"></pre>
    <textarea id="code" spellcheck="false">
<!DOCTYPE html>
<html>
<head>
<style>
body {
  font-family: Arial;
  background: #f4f4f4;
}
h1 { color: purple; }
</style>
</head>

<body>
<h1>Hello Starlight</h1>
<p>Edit HTML, CSS & JS together.</p>

<script>
console.log("Starlight ready!");
</script>
</body>
</html>
    </textarea>
  </div>
</div>

<!-- Preview -->
<div class="preview">
  <div class="preview-top">
    <img class="logo" src="https://dominexmacedon.github.io/starlight-programming-language/logo/starlight-lang-logo.png">
  </div>
  <iframe id="output"></iframe>
</div>

<script>
const textarea = document.getElementById("code");
const highlight = document.getElementById("highlight");

/* Simple syntax highlighting */
function highlightCode(code) {
  return code
    .replace(/(&lt;!--[\s\S]*?--&gt;)/g, '<span class="comment">$1</span>')
    .replace(/(&lt;\/?[a-z]+.*?&gt;)/gi, '<span class="tag">$1</span>')
    .replace(/("[^"]*")/g, '<span class="string">$1</span>')
    .replace(/\b(function|return|let|var|const|if|else|for|while)\b/g,
      '<span class="keyword">$1</span>');
}

function syncHighlight() {
  let code = textarea.value
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;");
  highlight.innerHTML = highlightCode(code);
}

textarea.addEventListener("input", syncHighlight);
textarea.addEventListener("scroll", () => {
  highlight.scrollTop = textarea.scrollTop;
});

/* Auto-pair brackets */
textarea.addEventListener("keydown", e => {
  const pairs = { "{": "}", "(": ")", "[": "]", '"': '"', "'": "'" };
  if (pairs[e.key]) {
    e.preventDefault();
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    textarea.value =
      textarea.value.slice(0, start) +
      e.key + pairs[e.key] +
      textarea.value.slice(end);
    textarea.selectionStart = textarea.selectionEnd = start + 1;
    syncHighlight();
  }
});

function runCode() {
  const iframe = document.getElementById("output");
  iframe.srcdoc = textarea.value;
}

syncHighlight();
runCode();
</script>

</body>
</html>
